%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Generally Useful Commands                                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcounter{rowcount}
\newcommand{\rowit}{
  \stepcounter{rowcount}
  \therowcount
}

\def\bul{$\bullet$}
\def\deg{$^{\circ}$}
\def\bul{$\bullet$}

\newcommand{\fixme}[1]{
  {\bf FIXME:}(#1)
}

\newcommand{\dmz}{
  \begin{minipage}{\linewidth}
    \vspace{0.2in}
    \hrule
    \hrule

    \par
    \vspace{0.05in}

    \begin{center}
      DMZ
    \end{center}

    \hrule
    \hrule
    \vspace{0.2in}
  \end{minipage}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Problems                                                                  %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% \definekeys{problem}{
%%   path .store in=\problem@path
%% %%  path .initial=3cm,
%% }
%\newcoommand{\problem}{
%% \NewDocumentCommand{\problem}{m}{%
%% \def\path{#1}
%% %  \setkeys{\problem}{#1}%
%% %  \problem@path
%% \path
%% }

\newenvironment{question}{%
\begin{quote}
}{%
\end{quote}
}

\NewDocumentCommand{\probChapter}{m}{
\setcounter{section}{#1-1}
\section{Chapter #1}
\input{\bookName/chapters/#1/chapter}
}

\NewDocumentCommand{\problem}{mm}{%
\setcounter{subsection}{#2-1}
\subsection{Problem #2}
\graphicspath{{\buildPath/\bookName/chapters/#1/problems/#2}}
\input{\bookName/chapters/#1/problems/#2/problem}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Generally Useful Environments                                             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{packedEnum}{%
  \begin{enumerate}
    \setlength{\itemsep}{0pt}
    \setlength{\parskip}{0pt}
    \setlength{\parsep}{0pt}
}{%
  \end{enumerate}
}

\newenvironment{packedItem}{%
  \begin{large}
  \begin{itemize}
    \setlength{\itemsep}{5pt}
    \setlength{\parskip}{0pt}
    \setlength{\parsep}{0pt}
}{%
  \end{itemize}
  \end{large}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Section & Heading Management                                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\jobSectionTitle}[1]{%
  \noindent
  \textbf{\large{#1}}
}%

\newcommand{\jobSection}[5]{%
  \def\jobTitle{#1}
  \def\jobOrg{#2}
  \def\jobStart{#3}
  \def\jobEnd{#4}
  \def\jobPath{#5}

  \ifthenelse{\equal{\jobStart}{}}{
    %% We don't have any dates (just the job)
    \jobSectionTitle{\jobTitle{}, \jobOrg{}}
  }{
    \ifthenelse{\equal{\jobEnd}{}}{
      %% There isn't a specified job end date, skip it
      \jobSectionTitle{\jobTitle{}, \jobOrg{} (\jobStart)}
    }{
      %% Use the job end date specified
      \jobSectionTitle{\jobTitle{}, \jobOrg{} (\jobStart{} \bul{} \jobEnd{})}
    }
  }

  \ifthenelse{\equal{\jobPath}{}}{%
  }{%
    \input{\jobPath}
  }%
  \vspace{8pt}
}

\newcommand*\ruleline[1]{%
  \vspace{0.1in}
  \par
  \noindent
  \raisebox{.8ex}{%
    \makebox[\linewidth]{%
      \hrulefill\hspace{1ex}\raisebox{-.8ex}{#1}\hspace{1ex}\hrulefill
    }%
  }%
}%

\newcommand{\sectionHeader}[1]{%
  \ruleline{{\bf \Large #1}}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Cover Letters (General)                                                   %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{jobDescriptor}{%
  %% FIXME: Figure this one out properly
  \vspace{-10pt}

  \begin{itemize}
    \setlength{\itemsep}{3pt}
    \setlength{\parskip}{0pt}
    \setlength{\parsep}{0pt}
}{%
  \end{itemize}%
  \vspace*{-\baselineskip}
}

\newenvironment{coverLetter}{%
  \begin{large}
}{%
  \end{large}%
}

\newenvironment{jobStory}{%
  \hfill\begin{minipage}{\dimexpr\textwidth-\parindent}
  \begin{flushleft}
  %%\begin{adjustwidth}{1.5em}{}
}{%
  \end{flushleft}
  \end{minipage}
  %%\end{adjustwidth}
}

\newenvironment{positionList}{%
  \begin{large}
  \begin{itemize}
}{%
  \end{itemize}
  \end{large}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Cover Letters (Qualifications Table)                                      %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% To use kwargs in LaTeX is a bit complicated -- we really need a
%% pythonic wrapper for LaTeX...my calling?
%%
%% 1) create a make-at-letter block to define the keys and default values
%%
%%     \makeatletter
%%     \define@key{qualTableArgs}{tocTitle}{\def\tocTitle{#1}}
%%     \define@key{qualTableArgs}{includeSummary}{\def\includeSummary{#1}}
%%     \setkeys{qualTableArgs}{includeSummary=true,tocTitle=}
%%     \makeatother
%%
%%
%% 2) Define your command/environment properly where
%%    n = number of positional arguments
%%
%%    \newcommand{\contribution}[n+1][]{%
%%
%%
%% 3) Snarf the arguments (both positional and keyword):
%%
%%    \setkeys{qualTableArgs}{#1} <-- Grabbing kwargs
%%    \def\secTitle{#2}           <-- Grabbing first positional argument
%%    \def\authorName{#3}         <-- Grabbing second positional argument
%%    ...
%%    \def\fname{#n+1}            <-- Grabbing the nth positional argument
%%
%% 4) Use the values (you know, the thing you wanted to do from the
%%    start).  This is actually the easy part, you just use them like
%%    you would any other LaTeX command:
%%
%%    kwargs[''tocTitle''] = \tocTitle
%%
%%
%% 5) Pass in some kwargs
%%
%%    \whatever[myKwarg=false]{positional}{arguments}{as}{usual}

\makeatletter
\define@key{qualTableArgs}{notes}{\def\notes{#1}}
\setkeys{qualTableArgs}{notes=}
\makeatother

\newenvironment{qualificationsTables}{%
  \begin{tabular}{cl}
    \Circle{} & Requirement unmet.\\
    \LEFTcircle{} & Requirement partially met.\\
    \CIRCLE{} & Requirement fully met.\\
  \end{tabular}
}{%
}

\newenvironment{qualificationsTable}[2][]{%

  \setkeys{qualTableArgs}{#1}
  \def\title{#2}

  \newpage
  \thispagestyle{plain}
  
  %% Table wide options
  \renewcommand{\arraystretch}{1.8}
  \rowcolors{2}{white}{gray!25}
  %%\tabcolsep=0pt

  {\centering}

  %%\begin{center}
    \begin{longtable}{cm{0.43\linewidth}m{0.43\linewidth}}

      %% First Page Header
      \rowcolor{lightgray}\multicolumn{3}{c}{%
        \ifthenelse{\equal{\notes}{}}{%
          {\bfseries \Large \title}%
        }{%
          {\bfseries \Large \title}%

          \notes
        }%
      }%
      \\

      \rowcolor{lightgray}
      & \multicolumn{1}{c}{\textbf{Job Requirement}}
      & \multicolumn{1}{c}{\textbf{Experience}} \\
      \hline 
      \endfirsthead

    % Subsequent Headers
      \hline
      \rowcolor{lightgray}
      & \multicolumn{1}{c}{\textbf{Job Requirement}}
      & \multicolumn{1}{c}{\textbf{Experience}} \\
      \hline 
      \endhead

      % Page Footers
      \hline
      \multicolumn{3}{r}{{Continued on next page}} \\
      \hline
      \endfoot

      % Final Footer
      \hline
      \hline
      \endlastfoot
}{%
    \end{longtable}
  %%\end{center}
}

\makeatletter
\define@key{qualItemArgs}{fullyMet}{\def\fullyMet{#1}}
\define@key{qualItemArgs}{partiallyMet}{\def\partiallyMet{#1}}
\define@key{qualItemArgs}{notMet}{\def\notMet{#1}}
\setkeys{qualItemArgs}{fullyMet=true, partiallyMet=false, notMet=false}
\setkeys{qualItemArgs}{fullyMet=true}
\makeatother%

\newcommand{\qualTableOptionals}{%
  \hline
  \multicolumn{3}{c}{%
    {\bfseries \large Secondary Requirements}%
  }\\
  \hline
}

\newcommand{\qualTableItem}[3][]{%

  \setkeys{qualItemArgs}{#1}

  \ifthenelse{\boolean{\notMet}}{%
    \Circle%
    & {\normalsize #2}%
    & {\normalsize #3}%
    \\
  }{%
    \ifthenelse{\boolean{\partiallyMet}}{%
      \LEFTcircle%
      & {\normalsize #2}%
      & {\normalsize #3}%
      \\
    }{%
      \CIRCLE
      & {\normalsize #2}%
      & {\normalsize #3}%
      \\
    }%
  }%
}

\newcommand{\coverIntro}[1]{%

  \begin{large}

    \ifthenelse{\equal{#1}{}}{%
      \input{covers/default}
    }{%
      #1
    }

    \begin{tabular}{cl}
      \Circle{} & Requirement unmet.\\
      \LEFTcircle{} & Requirement partially met.\\
      \CIRCLE{} & Requirement fully met.\\
    \end{tabular}

  \end{large}
}
